<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>Splay Tree - Zeyuan Hu's website</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="../../../../../posts/2017/Feb/13/splay-tree/">

        <meta name="author" content="Zeyuan Hu" />
        <meta name="keywords" content="trees,maw" />
        <meta name="description" content="This is the summary of Splay tree part in MAW Chapter 4. Motivation Ordinary BST has no balance conditions and thus, it is possible for a whole sequnece of \(O(N)\) accesses to take place. This cumulative running time then becomes noticeable. So, we introduce the balance condition on BST ..." />

        <meta property="og:site_name" content="Zeyuan Hu's website" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="Splay Tree"/>
        <meta property="og:url" content="../../../../../posts/2017/Feb/13/splay-tree/"/>
        <meta property="og:description" content="This is the summary of Splay tree part in MAW Chapter 4. Motivation Ordinary BST has no balance conditions and thus, it is possible for a whole sequnece of \(O(N)\) accesses to take place. This cumulative running time then becomes noticeable. So, we introduce the balance condition on BST ..."/>
        <meta property="article:published_time" content="2017-02-13" />
            <meta property="article:section" content="Data Struct & Algo" />
            <meta property="article:tag" content="trees" />
            <meta property="article:tag" content="maw" />
            <meta property="article:author" content="Zeyuan Hu" />


    <!-- Bootstrap -->
        <link rel="stylesheet" href="../../../../../theme/css/bootstrap.lumen.min.css" type="text/css"/>
    <link href="../../../../../theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="../../../../../theme/css/pygments/emacs.css" rel="stylesheet">
    <link rel="stylesheet" href="../../../../../theme/css/style.css" type="text/css"/>

        <link href="../../../../../feeds/all.atom.xml" type="application/atom+xml" rel="alternate"
              title="Zeyuan Hu's website ATOM Feed"/>

        <link href="../../../../../feeds/all.rss.xml" type="application/rss+xml" rel="alternate"
              title="Zeyuan Hu's website RSS Feed"/>



</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
	<div class="container">
        <div class="navbar-header">
            <a href="../../../../../" class="navbar-brand">
Zeyuan Hu's website            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
              <li><a href="../../../../../about-zack.html"><i class="fa fa-question"></i><span class="icon-label">About</span></a></li>
              <li><a href="../../../../../archives/index.html"><i class="fa fa-th-list"></i><span class="icon-label">Archives</span></a></li>
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->
<!-- Banner -->
<!-- End Banner -->
<div class="container">
    <div class="row">
        <div class="col-lg-12">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="../../../../../posts/2017/Feb/13/splay-tree/"
                       rel="bookmark"
                       title="Permalink to Splay Tree">
                        Splay Tree
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
        <i class="fa fa-calendar"></i><time datetime="2017-02-13T01:12:00+08:00"> Mon 13 Feb 2017, 01:12</time>
    </span>





<span class="label label-default">Tags</span>
	<a href="../../../../../tag/trees.html">trees</a>
        /
	<a href="../../../../../tag/maw.html">maw</a>
    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>This is the summary of <em>Splay tree</em> part in MAW Chapter 4.</p>
<h2>Motivation</h2>
<p>Ordinary BST has no balance conditions and thus, it is possible for a whole sequnece of <span class="math">\(O(N)\)</span> accesses to take place. This cumulative running time 
then becomes noticeable. So, we introduce the balance condition on BST to improve our running time. One way to do so is to enforce a balance condition
when nodes change (i.e. insert or delete) like AVL. However, this data structure is hard to code and rebalancing costs time. In addition, sometimes it is 
OK for us to have <span class="math">\(O(N)\)</span> operation as long as it occurs infrequently. In other words, A search data structure with <span class="math">\(O(N)\)</span> worst-case time, but a <em>guarantee</em>
of at most <span class="math">\(O(M \log N)\)</span> for any <span class="math">\(M\)</span> consecutive operations, is good enough. Splay tree meets our needs. It is a data structure that 
lies right in-between BST (no balance condition) and AVL (very strict balance condition).</p>
<h2>Concept</h2>
<p>A splay tree is a type of balanced binary search tree. Structurally, it is identical to an ordinary binary search tree; the only difference is in the 
algorithms for finding, inserting, and deleting entries. Specifically, splay tree is a self-adjusting tree, which the structure get organized over time
as nodes are accessed (i.e., insert, delete, or find). This makes sense because if we don't re-structure the tree each time we access an node, then 
the amortized time bound should be <span class="math">\(O(M N)\)</span> for a sequence of <span class="math">\(M\)</span> accesses instead of <span class="math">\(O(M \log N)\)</span>.</p>
<p>The way we restructure the tree is called <em>splaying</em>. Chapter 4 talks about bottom-up splaying algorithms. Every time a node is accessed in a splay tree,
it is moved to the root of the tree. The amortized cost of the operation is <span class="math">\(O(\log N)\)</span>. As shown by MAW, simply moving the element to the root by
rotating it up the trees does not have this property. However, the following three structuring rules do guarantee this amortized bound.</p>
<div class="highlight"><pre><span></span>                             y             x
   Zig (terminal case):     /     ====&gt;     \               (same as AVL single rotation)
                           x                 y

                    z              z
                   /              /             x
   Zig-zag:       y     ====&gt;    x   ====&gt;     / \          (same as AVL double rotation)
                   \            /             y   z
                    x          y

                    z                         x
                   /            y              \
   Zig-zig:       y     ====&gt;  / \   ====&gt;      y
                 /            x   z              \
                x                                 z
</pre></div>


<p>In the above pictures, x is the node that was accessed (that will
eventually be at the root of the tree).  By looking at the local
structure of the tree defined by x, x's parent, and x's grandparent we
decide which of three rules to follow.  We continue to
apply the rules until x is at the root of the tree.</p>
<div class="highlight"><pre><span></span>Splay(1)

              7                    7                   7               1
             /                    /                   /                 \
            6                    6                   6                   6
           /                    /                   /                   / \
          5                    5                   1                   4   7 
         /      =======&gt;      /        =======&gt;     \    ======&gt;      / \
        4                    4                       4               2   5
       /                    /                       / \               \
      3                    1                       2   5               3
     /                      \                       \
    2                        2                       3
   /                          \
  1                            3
</pre></div>


<h2>Implementation details</h2>
<p>Splay tree is really a flexible data structure in the sense that there are many options to implement 
the "splay" rules and corresponding tree operations and still have the property hold. Reference <a href="https://en.wikipedia.org/wiki/Splay_tree">wiki</a>
for complete summary. Here, I only mention some of my findings. Please note that depends on how you implement your operations, the resulting tree
may be different (i.e. different insert algorithm may result in different tree structure but there root will be the same).</p>
<h3>Insertion (bottom-up)</h3>
<p>There are two ways to do this. The first way is to use "split" to split the tree based upon the insertion value. By the property of splaying, 
we will either have the insertion value (already inside the tree) or the parent of the insertion point at the root. Then we can make our insertion 
value as the new root and adjust the orginal tree to form the new tree. For example,  if the insertion value <code>elem</code> smaller than the root, we do</p>
<div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">elem</span> <span class="o">&lt;</span> <span class="n">T</span><span class="o">-&gt;</span><span class="n">Element</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">newT</span><span class="o">-&gt;</span><span class="n">Right</span> <span class="o">=</span> <span class="n">T</span><span class="p">;</span>
  <span class="n">newT</span><span class="o">-&gt;</span><span class="n">Left</span> <span class="o">=</span> <span class="n">T</span><span class="o">-&gt;</span><span class="n">Left</span><span class="p">;</span> <span class="c1">// we can do this b/c the result of splaying is the parent node of where we should insert.</span>
  <span class="n">T</span><span class="o">-&gt;</span><span class="n">Left</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<p>The code is straightforward but <code>newT-&gt;Left = T-&gt;Left</code> is worth a remark. Here, when <code>T</code> is the parent of the insertion point, 
we know <code>T</code>'s left subtree's values are smaller than <code>elem</code> as well. This is because 
if there is any node <span class="math">\(x\)</span> greater than <code>elem</code> but smaller than <code>T</code>'s value, then <code>T</code> should be <span class="math">\(x\)</span> instead (by splaying), which is a contradiction.</p>
<p>The second way is to do BST insertion first and then splay the insertion value, which is really straightforward and easy to code. </p>
<h2>Deletion (bottom-up)</h2>
<p>Correspondingly there are two methods to deletion as well. The first way is to splay the to-be-deleted node. This puts the node at the root. If it is
deleted, we get two subtrees <span class="math">\(T_L\)</span> and <span class="math">\(T_R\)</span>. If we find the largest element in <span class="math">\(T_L\)</span>, then this element is rotated to the root of <span class="math">\(T_L\)</span>, and 
<span class="math">\(T_L\)</span> will now have a root with no right child. We can finish the deletion by making <span class="math">\(T_R\)</span> the right child.</p>
<p>The second way is to do BST deletion first, and then splay the parent of the deletion point to the root. It is quite similar to BST deletion and see
the implementation <a href="https://github.com/xxks-kkk/algo/blob/master/trees/splay/splay.c">here</a>.</p>
<h2>Properties</h2>
<ul>
<li>any <span class="math">\(M\)</span> consecutive tree operations starting from an empty tree take at most <span class="math">\(O(M \log N)\)</span> time.</li>
<li>Even though the worst-case running time is <span class="math">\(O(N)\)</span> for operation, the amortized cost of the operation is <span class="math">\(O(\log N)\)</span>.</li>
<li>if all nodes in a splay tree are accessed in sequential order, the resulting tree consists of a chain of left children. (MAW 4.26.a)</li>
<li>if all nodes in a splay tree are accessed in sequential order, then the total access time is <span class="math">\(O(N)\)</span>, regardless of the initial tree.</li>
</ul>
<h2>Pros &amp; Cons of data structure</h2>
<p>Splay tree is simpler and easier to program. Because of its implicity, splay tree insertion and deletion is typically faster in practice.
Find operation can be faster or slower, depending on circumstances. Splay trees are designed to give especially fast access to nodes that 
have been accessed recently, so they really excel in applications where a small fraction of the nodes are the targets of most of the find operation.</p>
<h2>Todo</h2>
<p>This post does not cover every part of the splay tree. This post will be updated once I complete the following two parts study:</p>
<ul>
<li>MAW Chapter 11 gives a thorough study of the amortized cost of the splay tree operations <span class="math">\(O( \log N)\)</span>.</li>
<li>MAW Chapter 12 gives implementation details on top-down splay tree.  </li>
</ul>
<h2>Reference</h2>
<ul>
<li>http://www.cs.cmu.edu/afs/cs/academic/class/15859-f05/www/documents/splay-trees.txt</li>
<li>http://web.stanford.edu/class/archive/cs/cs166/cs166.1146/lectures/08/Small08.pdf (proof of properties in a concise structure)</li>
<li>http://digital.cs.usu.edu/~allan/DS/Notes/Ch22.pdf</li>
<li>https://courses.cs.washington.edu/courses/cse373/06sp/handouts/lecture14.pdf</li>
<li>https://people.eecs.berkeley.edu/~jrs/61b/lec/36</li>
</ul>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    var location_protocol = (false) ? 'https' : document.location.protocol;
    if (location_protocol !== 'http' && location_protocol !== 'https') location_protocol = 'https:';
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = location_protocol + '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' }, Macros: {} }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
            </div>
            <!-- /.entry-content -->
    <hr/>
    <section class="comments" id="comments">
        <h2>Comments</h2>

        <div id="disqus_thread"></div>
        <script type="text/javascript">
            /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
            var disqus_shortname = 'zhu45-org'; // required: replace example with your forum shortname

                    var disqus_identifier = 'splay-tree';
                var disqus_url = '../../../../../posts/2017/Feb/13/splay-tree/';

            var disqus_config = function () {
                this.language = "en";
            };

            /* * * DON'T EDIT BELOW THIS LINE * * */
            (function () {
                var dsq = document.createElement('script');
                dsq.type = 'text/javascript';
                dsq.async = true;
                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
            })();
        </script>
        <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by
            Disqus.</a></noscript>
        <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

    </section>
        </article>
    </section>

        </div>
    </div>
</div>
<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2015-2017 Zeyuan Hu
           <!-- &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>-->         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="../../../../../theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="../../../../../theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="../../../../../theme/js/respond.min.js"></script>

    <!-- Disqus -->
    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'zhu45-org'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script');
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>
    <!-- End Disqus Code -->
    <!-- Google Analytics -->
    <script type="text/javascript">

        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-37565522-2']);
        _gaq.push(['_trackPageview']);

        (function () {
            var ga = document.createElement('script');
            ga.type = 'text/javascript';
            ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(ga, s);
        })();
    </script>
    <!-- End Google Analytics Code -->

</body>
</html>